<div class="task-form-container">
  <div class="form-header">
    <h2>{{ getFormTitle() }}</h2>
    <button class="btn-close" (click)="onCancel()">✕</button>
  </div>

  <form (ngSubmit)="onSubmit()" #taskForm="ngForm">
    <div class="form-group">
      <label for="title">Título *</label>
      <input 
        type="text" 
        id="title" 
        name="title"
        [(ngModel)]="formData.title" 
        required 
        maxlength="200"
        #title="ngModel"
        class="form-control"
        placeholder="Digite o título da tarefa">
      <div *ngIf="title.invalid && title.touched" class="error-message">
        <span *ngIf="title.errors?.['required']">Título é obrigatório</span>
        <span *ngIf="title.errors?.['maxlength']">Título deve ter no máximo 200 caracteres</span>
      </div>
    </div>

    <div class="form-group">
      <label for="description">Descrição</label>
      <textarea 
        id="description" 
        name="description"
        [(ngModel)]="formData.description" 
        maxlength="1000"
        #description="ngModel"
        class="form-control"
        rows="3"
        placeholder="Digite uma descrição para a tarefa (opcional)">
      </textarea>
      <div *ngIf="description.invalid && description.touched" class="error-message">
        <span *ngIf="description.errors?.['maxlength']">Descrição deve ter no máximo 1000 caracteres</span>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="taskDate">Data *</label>
        <input 
          type="date" 
          id="taskDate" 
          name="taskDate"
          [(ngModel)]="formData.taskDate" 
          required 
          #taskDate="ngModel"
          class="form-control">
        <div *ngIf="taskDate.invalid && taskDate.touched" class="error-message">
          <span *ngIf="taskDate.errors?.['required']">Data é obrigatória</span>
        </div>
      </div>

      <div class="form-group" *ngIf="task">
        <label for="completed">Status</label>
        <div class="checkbox-group">
          <input 
            type="checkbox" 
            id="completed" 
            name="completed"
            [(ngModel)]="formData.completed">
          <label for="completed">Tarefa concluída</label>
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="priority">Prioridade</label>
        <select 
          id="priority" 
          name="priority"
          [(ngModel)]="formData.priority" 
          class="form-control">
          <option *ngFor="let priority of priorities" [value]="priority.value">
            {{ priority.label }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="category">Categoria</label>
        <select 
          id="category" 
          name="category"
          [(ngModel)]="formData.category" 
          class="form-control">
          <option *ngFor="let category of categories" [value]="category.value">
            {{ category.label }}
          </option>
        </select>
      </div>
    </div>

    <div *ngIf="error" class="error-message">
      {{ error }}
    </div>

    <div class="form-actions">
      <button 
        type="button" 
        class="btn btn-secondary"
        (click)="onCancel()">
        Cancelar
      </button>
      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="taskForm.invalid || loading">
        {{ getSubmitButtonText() }}
      </button>
    </div>
  </form>
</div>

